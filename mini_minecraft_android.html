<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minecraft Mobile - Trees & Lake</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87ceeb; touch-action: none; font-family: sans-serif; user-select: none; }
        canvas { display: block; width: 100vw; height: 100vh; }
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .touch-btn { position: absolute; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.5); border-radius: 8px; pointer-events: auto; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
        #btn-up { bottom: 130px; left: 85px; width: 55px; height: 55px; }
        #btn-down { bottom: 20px; left: 85px; width: 55px; height: 55px; }
        #btn-left { bottom: 75px; left: 20px; width: 55px; height: 55px; }
        #btn-right { bottom: 75px; left: 150px; width: 55px; height: 55px; }
        .action-btn { position: absolute; border-radius: 50%; border: 2px solid white; pointer-events: auto; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; }
        #btn-jump { bottom: 30px; right: 130px; width: 70px; height: 70px; background: rgba(255,255,255,0.2); }
        #btn-build { bottom: 110px; right: 30px; width: 80px; height: 80px; background: rgba(76, 175, 80, 0.6); }
        #btn-destroy { bottom: 20px; right: 30px; width: 80px; height: 80px; background: rgba(244, 67, 54, 0.6); }
        #inventory { position: absolute; top: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 8px; pointer-events: auto; background: rgba(0,0,0,0.5); padding: 5px; border-radius: 10px; }
        .slot { width: 40px; height: 40px; border: 2px solid #444; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        .slot.active { border-color: #fff; box-shadow: 0 0 10px #fff; }
        #crosshair { position: absolute; top: 50%; left: 50%; width: 14px; height: 14px; border: 2px solid white; transform: translate(-50%, -50%); border-radius: 50%; opacity: 0.7; }
    </style>
</head>
<body>

<div id="ui-layer">
    <div id="crosshair"></div>
    <div id="inventory">
        <div class="slot active" onclick="window.setBlock(1)"><div style="width:25px;height:25px;background:#5d8233"></div></div> <div class="slot" onclick="window.setBlock(4)"><div style="width:25px;height:25px;background:#614126"></div></div> <div class="slot" onclick="window.setBlock(6)"><div style="width:25px;height:25px;background:#2e7d32"></div></div> <div class="slot" onclick="window.setBlock(3)"><div style="width:25px;height:25px;background:#808080"></div></div> <div class="slot" onclick="window.setBlock(5)"><div style="width:25px;height:25px;background:#1e88e5"></div></div> </div>
    <div class="touch-btn" id="btn-up">W</div><div class="touch-btn" id="btn-down">S</div>
    <div class="touch-btn" id="btn-left">A</div><div class="touch-btn" id="btn-right">D</div>
    <div class="action-btn" id="btn-build">BUILD</div>
    <div class="action-btn" id="btn-destroy">KILL</div>
    <div class="action-btn" id="btn-jump">JUMP</div>
</div>

<script type="importmap">
    { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
</script>

<script type="module">
    import * as THREE from 'three';

    let scene, camera, renderer, yawObj, pitchObj, raycaster;
    let move = { f: 0, b: 0, l: 0, r: 0 };
    let velocity = new THREE.Vector3(0, 0, 0);
    let canJump = false, isInWater = false;
    let objects = [], pigs = [];
    let selectedBlock = 1, lastTouchX = 0, lastTouchY = 0;

    const mapSize = 50;
    const playerHeight = 1.7;
    const blockColors = { 1: 0x5d8233, 2: 0x795548, 3: 0x808080, 4: 0x614126, 5: 0x1e88e5, 6: 0x2e7d32 };

    init();

    function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87ceeb);
        scene.fog = new THREE.Fog(0x87ceeb, 20, 65);
        
        camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        pitchObj = new THREE.Object3D(); pitchObj.add(camera);
        yawObj = new THREE.Object3D(); yawObj.add(pitchObj);
        yawObj.position.set(5, 5, 5); scene.add(yawObj);

        renderer = new THREE.WebGLRenderer({ antialias: false });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        scene.add(new THREE.AmbientLight(0xffffff, 1.






